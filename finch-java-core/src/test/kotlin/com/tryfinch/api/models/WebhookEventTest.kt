// File generated from our OpenAPI spec by Stainless.

package com.tryfinch.api.models

import com.fasterxml.jackson.module.kotlin.jacksonTypeRef
import com.tryfinch.api.core.JsonValue
import com.tryfinch.api.core.jsonMapper
import com.tryfinch.api.errors.FinchInvalidDataException
import org.assertj.core.api.Assertions.assertThat
import org.junit.jupiter.api.Test
import org.junit.jupiter.api.assertThrows
import org.junit.jupiter.params.ParameterizedTest
import org.junit.jupiter.params.provider.EnumSource

internal class WebhookEventTest {

    @Test
    fun ofAccountUpdated() {
        val accountUpdated =
            AccountUpdateEvent.builder()
                .accountId("account_id")
                .companyId("company_id")
                .connectionId("connection_id")
                .data(
                    AccountUpdateEvent.Data.builder()
                        .authenticationMethod(
                            AccountUpdateEvent.Data.AuthenticationMethod.builder()
                                .benefitsSupport(
                                    BenefitsSupport.builder()
                                        .commuter(
                                            BenefitFeaturesAndOperations.builder()
                                                .supportedFeatures(
                                                    BenefitFeaturesAndOperations.BenefitFeature
                                                        .builder()
                                                        .annualMaximum(true)
                                                        .catchUp(true)
                                                        .addCompanyContribution(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .CompanyContribution
                                                                .FIXED
                                                        )
                                                        .description("description")
                                                        .addEmployeeDeduction(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .EmployeeDeduction
                                                                .FIXED
                                                        )
                                                        .addFrequency(BenefitFrequency.ONE_TIME)
                                                        .addHsaContributionLimit(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .HsaContributionLimit
                                                                .INDIVIDUAL
                                                        )
                                                        .build()
                                                )
                                                .supportedOperations(
                                                    SupportPerBenefitType.builder()
                                                        .companyBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .individualBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .build()
                                                )
                                                .build()
                                        )
                                        .customPostTax(
                                            BenefitFeaturesAndOperations.builder()
                                                .supportedFeatures(
                                                    BenefitFeaturesAndOperations.BenefitFeature
                                                        .builder()
                                                        .annualMaximum(true)
                                                        .catchUp(true)
                                                        .addCompanyContribution(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .CompanyContribution
                                                                .FIXED
                                                        )
                                                        .description("description")
                                                        .addEmployeeDeduction(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .EmployeeDeduction
                                                                .FIXED
                                                        )
                                                        .addFrequency(BenefitFrequency.ONE_TIME)
                                                        .addHsaContributionLimit(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .HsaContributionLimit
                                                                .INDIVIDUAL
                                                        )
                                                        .build()
                                                )
                                                .supportedOperations(
                                                    SupportPerBenefitType.builder()
                                                        .companyBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .individualBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .build()
                                                )
                                                .build()
                                        )
                                        .customPreTax(
                                            BenefitFeaturesAndOperations.builder()
                                                .supportedFeatures(
                                                    BenefitFeaturesAndOperations.BenefitFeature
                                                        .builder()
                                                        .annualMaximum(true)
                                                        .catchUp(true)
                                                        .addCompanyContribution(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .CompanyContribution
                                                                .FIXED
                                                        )
                                                        .description("description")
                                                        .addEmployeeDeduction(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .EmployeeDeduction
                                                                .FIXED
                                                        )
                                                        .addFrequency(BenefitFrequency.ONE_TIME)
                                                        .addHsaContributionLimit(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .HsaContributionLimit
                                                                .INDIVIDUAL
                                                        )
                                                        .build()
                                                )
                                                .supportedOperations(
                                                    SupportPerBenefitType.builder()
                                                        .companyBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .individualBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .build()
                                                )
                                                .build()
                                        )
                                        .fsaDependentCare(
                                            BenefitFeaturesAndOperations.builder()
                                                .supportedFeatures(
                                                    BenefitFeaturesAndOperations.BenefitFeature
                                                        .builder()
                                                        .annualMaximum(true)
                                                        .catchUp(true)
                                                        .addCompanyContribution(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .CompanyContribution
                                                                .FIXED
                                                        )
                                                        .description("description")
                                                        .addEmployeeDeduction(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .EmployeeDeduction
                                                                .FIXED
                                                        )
                                                        .addFrequency(BenefitFrequency.ONE_TIME)
                                                        .addHsaContributionLimit(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .HsaContributionLimit
                                                                .INDIVIDUAL
                                                        )
                                                        .build()
                                                )
                                                .supportedOperations(
                                                    SupportPerBenefitType.builder()
                                                        .companyBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .individualBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .build()
                                                )
                                                .build()
                                        )
                                        .fsaMedical(
                                            BenefitFeaturesAndOperations.builder()
                                                .supportedFeatures(
                                                    BenefitFeaturesAndOperations.BenefitFeature
                                                        .builder()
                                                        .annualMaximum(true)
                                                        .catchUp(true)
                                                        .addCompanyContribution(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .CompanyContribution
                                                                .FIXED
                                                        )
                                                        .description("description")
                                                        .addEmployeeDeduction(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .EmployeeDeduction
                                                                .FIXED
                                                        )
                                                        .addFrequency(BenefitFrequency.ONE_TIME)
                                                        .addHsaContributionLimit(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .HsaContributionLimit
                                                                .INDIVIDUAL
                                                        )
                                                        .build()
                                                )
                                                .supportedOperations(
                                                    SupportPerBenefitType.builder()
                                                        .companyBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .individualBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .build()
                                                )
                                                .build()
                                        )
                                        .hsaPost(
                                            BenefitFeaturesAndOperations.builder()
                                                .supportedFeatures(
                                                    BenefitFeaturesAndOperations.BenefitFeature
                                                        .builder()
                                                        .annualMaximum(true)
                                                        .catchUp(true)
                                                        .addCompanyContribution(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .CompanyContribution
                                                                .FIXED
                                                        )
                                                        .description("description")
                                                        .addEmployeeDeduction(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .EmployeeDeduction
                                                                .FIXED
                                                        )
                                                        .addFrequency(BenefitFrequency.ONE_TIME)
                                                        .addHsaContributionLimit(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .HsaContributionLimit
                                                                .INDIVIDUAL
                                                        )
                                                        .build()
                                                )
                                                .supportedOperations(
                                                    SupportPerBenefitType.builder()
                                                        .companyBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .individualBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .build()
                                                )
                                                .build()
                                        )
                                        .hsaPre(
                                            BenefitFeaturesAndOperations.builder()
                                                .supportedFeatures(
                                                    BenefitFeaturesAndOperations.BenefitFeature
                                                        .builder()
                                                        .annualMaximum(true)
                                                        .catchUp(true)
                                                        .addCompanyContribution(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .CompanyContribution
                                                                .FIXED
                                                        )
                                                        .description("description")
                                                        .addEmployeeDeduction(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .EmployeeDeduction
                                                                .FIXED
                                                        )
                                                        .addFrequency(BenefitFrequency.ONE_TIME)
                                                        .addHsaContributionLimit(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .HsaContributionLimit
                                                                .INDIVIDUAL
                                                        )
                                                        .build()
                                                )
                                                .supportedOperations(
                                                    SupportPerBenefitType.builder()
                                                        .companyBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .individualBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .build()
                                                )
                                                .build()
                                        )
                                        .s125Dental(
                                            BenefitFeaturesAndOperations.builder()
                                                .supportedFeatures(
                                                    BenefitFeaturesAndOperations.BenefitFeature
                                                        .builder()
                                                        .annualMaximum(true)
                                                        .catchUp(true)
                                                        .addCompanyContribution(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .CompanyContribution
                                                                .FIXED
                                                        )
                                                        .description("description")
                                                        .addEmployeeDeduction(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .EmployeeDeduction
                                                                .FIXED
                                                        )
                                                        .addFrequency(BenefitFrequency.ONE_TIME)
                                                        .addHsaContributionLimit(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .HsaContributionLimit
                                                                .INDIVIDUAL
                                                        )
                                                        .build()
                                                )
                                                .supportedOperations(
                                                    SupportPerBenefitType.builder()
                                                        .companyBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .individualBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .build()
                                                )
                                                .build()
                                        )
                                        .s125Medical(
                                            BenefitFeaturesAndOperations.builder()
                                                .supportedFeatures(
                                                    BenefitFeaturesAndOperations.BenefitFeature
                                                        .builder()
                                                        .annualMaximum(true)
                                                        .catchUp(true)
                                                        .addCompanyContribution(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .CompanyContribution
                                                                .FIXED
                                                        )
                                                        .description("description")
                                                        .addEmployeeDeduction(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .EmployeeDeduction
                                                                .FIXED
                                                        )
                                                        .addFrequency(BenefitFrequency.ONE_TIME)
                                                        .addHsaContributionLimit(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .HsaContributionLimit
                                                                .INDIVIDUAL
                                                        )
                                                        .build()
                                                )
                                                .supportedOperations(
                                                    SupportPerBenefitType.builder()
                                                        .companyBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .individualBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .build()
                                                )
                                                .build()
                                        )
                                        .s125Vision(
                                            BenefitFeaturesAndOperations.builder()
                                                .supportedFeatures(
                                                    BenefitFeaturesAndOperations.BenefitFeature
                                                        .builder()
                                                        .annualMaximum(true)
                                                        .catchUp(true)
                                                        .addCompanyContribution(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .CompanyContribution
                                                                .FIXED
                                                        )
                                                        .description("description")
                                                        .addEmployeeDeduction(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .EmployeeDeduction
                                                                .FIXED
                                                        )
                                                        .addFrequency(BenefitFrequency.ONE_TIME)
                                                        .addHsaContributionLimit(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .HsaContributionLimit
                                                                .INDIVIDUAL
                                                        )
                                                        .build()
                                                )
                                                .supportedOperations(
                                                    SupportPerBenefitType.builder()
                                                        .companyBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .individualBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .build()
                                                )
                                                .build()
                                        )
                                        .simple(
                                            BenefitFeaturesAndOperations.builder()
                                                .supportedFeatures(
                                                    BenefitFeaturesAndOperations.BenefitFeature
                                                        .builder()
                                                        .annualMaximum(true)
                                                        .catchUp(true)
                                                        .addCompanyContribution(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .CompanyContribution
                                                                .FIXED
                                                        )
                                                        .description("description")
                                                        .addEmployeeDeduction(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .EmployeeDeduction
                                                                .FIXED
                                                        )
                                                        .addFrequency(BenefitFrequency.ONE_TIME)
                                                        .addHsaContributionLimit(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .HsaContributionLimit
                                                                .INDIVIDUAL
                                                        )
                                                        .build()
                                                )
                                                .supportedOperations(
                                                    SupportPerBenefitType.builder()
                                                        .companyBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .individualBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .build()
                                                )
                                                .build()
                                        )
                                        .simpleIra(
                                            BenefitFeaturesAndOperations.builder()
                                                .supportedFeatures(
                                                    BenefitFeaturesAndOperations.BenefitFeature
                                                        .builder()
                                                        .annualMaximum(true)
                                                        .catchUp(true)
                                                        .addCompanyContribution(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .CompanyContribution
                                                                .FIXED
                                                        )
                                                        .description("description")
                                                        .addEmployeeDeduction(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .EmployeeDeduction
                                                                .FIXED
                                                        )
                                                        .addFrequency(BenefitFrequency.ONE_TIME)
                                                        .addHsaContributionLimit(
                                                            BenefitFeaturesAndOperations
                                                                .BenefitFeature
                                                                .HsaContributionLimit
                                                                .INDIVIDUAL
                                                        )
                                                        .build()
                                                )
                                                .supportedOperations(
                                                    SupportPerBenefitType.builder()
                                                        .companyBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .individualBenefits(
                                                            OperationSupportMatrix.builder()
                                                                .create(OperationSupport.SUPPORTED)
                                                                .delete(OperationSupport.SUPPORTED)
                                                                .read(OperationSupport.SUPPORTED)
                                                                .update(OperationSupport.SUPPORTED)
                                                                .build()
                                                        )
                                                        .build()
                                                )
                                                .build()
                                        )
                                        .build()
                                )
                                .supportedFields(
                                    AccountUpdateEvent.Data.AuthenticationMethod.SupportedFields
                                        .builder()
                                        .company(
                                            AccountUpdateEvent.Data.AuthenticationMethod
                                                .SupportedFields
                                                .SupportedCompanyFields
                                                .builder()
                                                .id(true)
                                                .accounts(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedCompanyFields
                                                        .Accounts
                                                        .builder()
                                                        .accountName(true)
                                                        .accountNumber(true)
                                                        .accountType(true)
                                                        .institutionName(true)
                                                        .routingNumber(true)
                                                        .build()
                                                )
                                                .departments(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedCompanyFields
                                                        .Departments
                                                        .builder()
                                                        .name(true)
                                                        .parent(
                                                            AccountUpdateEvent.Data
                                                                .AuthenticationMethod
                                                                .SupportedFields
                                                                .SupportedCompanyFields
                                                                .Departments
                                                                .Parent
                                                                .builder()
                                                                .name(true)
                                                                .build()
                                                        )
                                                        .build()
                                                )
                                                .ein(true)
                                                .entity(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedCompanyFields
                                                        .Entity
                                                        .builder()
                                                        .subtype(true)
                                                        .type(true)
                                                        .build()
                                                )
                                                .legalName(true)
                                                .locations(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedCompanyFields
                                                        .Locations
                                                        .builder()
                                                        .city(true)
                                                        .country(true)
                                                        .line1(true)
                                                        .line2(true)
                                                        .postalCode(true)
                                                        .state(true)
                                                        .build()
                                                )
                                                .primaryEmail(true)
                                                .primaryPhoneNumber(true)
                                                .build()
                                        )
                                        .directory(
                                            AccountUpdateEvent.Data.AuthenticationMethod
                                                .SupportedFields
                                                .SupportedDirectoryFields
                                                .builder()
                                                .individuals(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedDirectoryFields
                                                        .Individuals
                                                        .builder()
                                                        .id(true)
                                                        .department(true)
                                                        .firstName(true)
                                                        .isActive(true)
                                                        .lastName(true)
                                                        .manager(
                                                            AccountUpdateEvent.Data
                                                                .AuthenticationMethod
                                                                .SupportedFields
                                                                .SupportedDirectoryFields
                                                                .Individuals
                                                                .Manager
                                                                .builder()
                                                                .id(true)
                                                                .build()
                                                        )
                                                        .middleName(true)
                                                        .build()
                                                )
                                                .paging(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedDirectoryFields
                                                        .Paging
                                                        .builder()
                                                        .count(true)
                                                        .offset(true)
                                                        .build()
                                                )
                                                .build()
                                        )
                                        .employment(
                                            AccountUpdateEvent.Data.AuthenticationMethod
                                                .SupportedFields
                                                .SupportedEmploymentFields
                                                .builder()
                                                .id(true)
                                                .classCode(true)
                                                .customFields(true)
                                                .department(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedEmploymentFields
                                                        .Department
                                                        .builder()
                                                        .name(true)
                                                        .build()
                                                )
                                                .employment(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedEmploymentFields
                                                        .Employment
                                                        .builder()
                                                        .subtype(true)
                                                        .type(true)
                                                        .build()
                                                )
                                                .employmentStatus(true)
                                                .endDate(true)
                                                .firstName(true)
                                                .income(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedEmploymentFields
                                                        .Income
                                                        .builder()
                                                        .amount(true)
                                                        .currency(true)
                                                        .unit(true)
                                                        .build()
                                                )
                                                .incomeHistory(true)
                                                .isActive(true)
                                                .lastName(true)
                                                .location(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedEmploymentFields
                                                        .Location
                                                        .builder()
                                                        .city(true)
                                                        .country(true)
                                                        .line1(true)
                                                        .line2(true)
                                                        .postalCode(true)
                                                        .state(true)
                                                        .build()
                                                )
                                                .manager(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedEmploymentFields
                                                        .Manager
                                                        .builder()
                                                        .id(true)
                                                        .build()
                                                )
                                                .middleName(true)
                                                .startDate(true)
                                                .title(true)
                                                .build()
                                        )
                                        .individual(
                                            AccountUpdateEvent.Data.AuthenticationMethod
                                                .SupportedFields
                                                .SupportedIndividualFields
                                                .builder()
                                                .id(true)
                                                .dob(true)
                                                .emails(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedIndividualFields
                                                        .Emails
                                                        .builder()
                                                        .data(true)
                                                        .type(true)
                                                        .build()
                                                )
                                                .encryptedSsn(true)
                                                .ethnicity(true)
                                                .firstName(true)
                                                .gender(true)
                                                .lastName(true)
                                                .middleName(true)
                                                .phoneNumbers(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedIndividualFields
                                                        .PhoneNumbers
                                                        .builder()
                                                        .data(true)
                                                        .type(true)
                                                        .build()
                                                )
                                                .preferredName(true)
                                                .residence(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedIndividualFields
                                                        .Residence
                                                        .builder()
                                                        .city(true)
                                                        .country(true)
                                                        .line1(true)
                                                        .line2(true)
                                                        .postalCode(true)
                                                        .state(true)
                                                        .build()
                                                )
                                                .ssn(true)
                                                .build()
                                        )
                                        .payGroup(
                                            AccountUpdateEvent.Data.AuthenticationMethod
                                                .SupportedFields
                                                .SupportedPayGroupFields
                                                .builder()
                                                .id(true)
                                                .individualIds(true)
                                                .name(true)
                                                .payFrequencies(true)
                                                .build()
                                        )
                                        .payStatement(
                                            AccountUpdateEvent.Data.AuthenticationMethod
                                                .SupportedFields
                                                .SupportedPayStatementFields
                                                .builder()
                                                .paging(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedPayStatementFields
                                                        .Paging
                                                        .builder()
                                                        .count(true)
                                                        .offset(true)
                                                        .build()
                                                )
                                                .payStatements(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedPayStatementFields
                                                        .PayStatements
                                                        .builder()
                                                        .earnings(
                                                            AccountUpdateEvent.Data
                                                                .AuthenticationMethod
                                                                .SupportedFields
                                                                .SupportedPayStatementFields
                                                                .PayStatements
                                                                .Earnings
                                                                .builder()
                                                                .amount(true)
                                                                .currency(true)
                                                                .name(true)
                                                                .type(true)
                                                                .build()
                                                        )
                                                        .employeeDeductions(
                                                            AccountUpdateEvent.Data
                                                                .AuthenticationMethod
                                                                .SupportedFields
                                                                .SupportedPayStatementFields
                                                                .PayStatements
                                                                .EmployeeDeductions
                                                                .builder()
                                                                .amount(true)
                                                                .currency(true)
                                                                .name(true)
                                                                .preTax(true)
                                                                .type(true)
                                                                .build()
                                                        )
                                                        .employerContributions(
                                                            AccountUpdateEvent.Data
                                                                .AuthenticationMethod
                                                                .SupportedFields
                                                                .SupportedPayStatementFields
                                                                .PayStatements
                                                                .EmployerContributions
                                                                .builder()
                                                                .amount(true)
                                                                .currency(true)
                                                                .name(true)
                                                                .build()
                                                        )
                                                        .grossPay(true)
                                                        .individualId(true)
                                                        .netPay(true)
                                                        .paymentMethod(true)
                                                        .taxes(
                                                            AccountUpdateEvent.Data
                                                                .AuthenticationMethod
                                                                .SupportedFields
                                                                .SupportedPayStatementFields
                                                                .PayStatements
                                                                .Taxes
                                                                .builder()
                                                                .amount(true)
                                                                .currency(true)
                                                                .employer(true)
                                                                .name(true)
                                                                .type(true)
                                                                .build()
                                                        )
                                                        .totalHours(true)
                                                        .type(true)
                                                        .build()
                                                )
                                                .build()
                                        )
                                        .payment(
                                            AccountUpdateEvent.Data.AuthenticationMethod
                                                .SupportedFields
                                                .SupportedPaymentFields
                                                .builder()
                                                .id(true)
                                                .companyDebit(true)
                                                .debitDate(true)
                                                .employeeTaxes(true)
                                                .employerTaxes(true)
                                                .grossPay(true)
                                                .individualIds(true)
                                                .netPay(true)
                                                .payDate(true)
                                                .payFrequencies(true)
                                                .payGroupIds(true)
                                                .payPeriod(
                                                    AccountUpdateEvent.Data.AuthenticationMethod
                                                        .SupportedFields
                                                        .SupportedPaymentFields
                                                        .PayPeriod
                                                        .builder()
                                                        .endDate(true)
                                                        .startDate(true)
                                                        .build()
                                                )
                                                .build()
                                        )
                                        .build()
                                )
                                .type(AccountUpdateEvent.Data.AuthenticationMethod.Type.ASSISTED)
                                .build()
                        )
                        .status(ConnectionStatusType.PENDING)
                        .build()
                )
                .eventType(AccountUpdateEvent.EventType.ACCOUNT_UPDATED)
                .build()

        val webhookEvent = WebhookEvent.ofAccountUpdated(accountUpdated)

        assertThat(webhookEvent.accountUpdated()).contains(accountUpdated)
        assertThat(webhookEvent.jobCompletion()).isEmpty
        assertThat(webhookEvent.companyUpdated()).isEmpty
        assertThat(webhookEvent.directory()).isEmpty
        assertThat(webhookEvent.employment()).isEmpty
        assertThat(webhookEvent.individual()).isEmpty
        assertThat(webhookEvent.payment()).isEmpty
        assertThat(webhookEvent.payStatement()).isEmpty
    }

    @Test
    fun ofAccountUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val webhookEvent =
            WebhookEvent.ofAccountUpdated(
                AccountUpdateEvent.builder()
                    .accountId("account_id")
                    .companyId("company_id")
                    .connectionId("connection_id")
                    .data(
                        AccountUpdateEvent.Data.builder()
                            .authenticationMethod(
                                AccountUpdateEvent.Data.AuthenticationMethod.builder()
                                    .benefitsSupport(
                                        BenefitsSupport.builder()
                                            .commuter(
                                                BenefitFeaturesAndOperations.builder()
                                                    .supportedFeatures(
                                                        BenefitFeaturesAndOperations.BenefitFeature
                                                            .builder()
                                                            .annualMaximum(true)
                                                            .catchUp(true)
                                                            .addCompanyContribution(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .CompanyContribution
                                                                    .FIXED
                                                            )
                                                            .description("description")
                                                            .addEmployeeDeduction(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .EmployeeDeduction
                                                                    .FIXED
                                                            )
                                                            .addFrequency(BenefitFrequency.ONE_TIME)
                                                            .addHsaContributionLimit(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .HsaContributionLimit
                                                                    .INDIVIDUAL
                                                            )
                                                            .build()
                                                    )
                                                    .supportedOperations(
                                                        SupportPerBenefitType.builder()
                                                            .companyBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .individualBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .build()
                                                    )
                                                    .build()
                                            )
                                            .customPostTax(
                                                BenefitFeaturesAndOperations.builder()
                                                    .supportedFeatures(
                                                        BenefitFeaturesAndOperations.BenefitFeature
                                                            .builder()
                                                            .annualMaximum(true)
                                                            .catchUp(true)
                                                            .addCompanyContribution(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .CompanyContribution
                                                                    .FIXED
                                                            )
                                                            .description("description")
                                                            .addEmployeeDeduction(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .EmployeeDeduction
                                                                    .FIXED
                                                            )
                                                            .addFrequency(BenefitFrequency.ONE_TIME)
                                                            .addHsaContributionLimit(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .HsaContributionLimit
                                                                    .INDIVIDUAL
                                                            )
                                                            .build()
                                                    )
                                                    .supportedOperations(
                                                        SupportPerBenefitType.builder()
                                                            .companyBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .individualBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .build()
                                                    )
                                                    .build()
                                            )
                                            .customPreTax(
                                                BenefitFeaturesAndOperations.builder()
                                                    .supportedFeatures(
                                                        BenefitFeaturesAndOperations.BenefitFeature
                                                            .builder()
                                                            .annualMaximum(true)
                                                            .catchUp(true)
                                                            .addCompanyContribution(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .CompanyContribution
                                                                    .FIXED
                                                            )
                                                            .description("description")
                                                            .addEmployeeDeduction(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .EmployeeDeduction
                                                                    .FIXED
                                                            )
                                                            .addFrequency(BenefitFrequency.ONE_TIME)
                                                            .addHsaContributionLimit(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .HsaContributionLimit
                                                                    .INDIVIDUAL
                                                            )
                                                            .build()
                                                    )
                                                    .supportedOperations(
                                                        SupportPerBenefitType.builder()
                                                            .companyBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .individualBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .build()
                                                    )
                                                    .build()
                                            )
                                            .fsaDependentCare(
                                                BenefitFeaturesAndOperations.builder()
                                                    .supportedFeatures(
                                                        BenefitFeaturesAndOperations.BenefitFeature
                                                            .builder()
                                                            .annualMaximum(true)
                                                            .catchUp(true)
                                                            .addCompanyContribution(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .CompanyContribution
                                                                    .FIXED
                                                            )
                                                            .description("description")
                                                            .addEmployeeDeduction(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .EmployeeDeduction
                                                                    .FIXED
                                                            )
                                                            .addFrequency(BenefitFrequency.ONE_TIME)
                                                            .addHsaContributionLimit(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .HsaContributionLimit
                                                                    .INDIVIDUAL
                                                            )
                                                            .build()
                                                    )
                                                    .supportedOperations(
                                                        SupportPerBenefitType.builder()
                                                            .companyBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .individualBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .build()
                                                    )
                                                    .build()
                                            )
                                            .fsaMedical(
                                                BenefitFeaturesAndOperations.builder()
                                                    .supportedFeatures(
                                                        BenefitFeaturesAndOperations.BenefitFeature
                                                            .builder()
                                                            .annualMaximum(true)
                                                            .catchUp(true)
                                                            .addCompanyContribution(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .CompanyContribution
                                                                    .FIXED
                                                            )
                                                            .description("description")
                                                            .addEmployeeDeduction(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .EmployeeDeduction
                                                                    .FIXED
                                                            )
                                                            .addFrequency(BenefitFrequency.ONE_TIME)
                                                            .addHsaContributionLimit(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .HsaContributionLimit
                                                                    .INDIVIDUAL
                                                            )
                                                            .build()
                                                    )
                                                    .supportedOperations(
                                                        SupportPerBenefitType.builder()
                                                            .companyBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .individualBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .build()
                                                    )
                                                    .build()
                                            )
                                            .hsaPost(
                                                BenefitFeaturesAndOperations.builder()
                                                    .supportedFeatures(
                                                        BenefitFeaturesAndOperations.BenefitFeature
                                                            .builder()
                                                            .annualMaximum(true)
                                                            .catchUp(true)
                                                            .addCompanyContribution(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .CompanyContribution
                                                                    .FIXED
                                                            )
                                                            .description("description")
                                                            .addEmployeeDeduction(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .EmployeeDeduction
                                                                    .FIXED
                                                            )
                                                            .addFrequency(BenefitFrequency.ONE_TIME)
                                                            .addHsaContributionLimit(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .HsaContributionLimit
                                                                    .INDIVIDUAL
                                                            )
                                                            .build()
                                                    )
                                                    .supportedOperations(
                                                        SupportPerBenefitType.builder()
                                                            .companyBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .individualBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .build()
                                                    )
                                                    .build()
                                            )
                                            .hsaPre(
                                                BenefitFeaturesAndOperations.builder()
                                                    .supportedFeatures(
                                                        BenefitFeaturesAndOperations.BenefitFeature
                                                            .builder()
                                                            .annualMaximum(true)
                                                            .catchUp(true)
                                                            .addCompanyContribution(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .CompanyContribution
                                                                    .FIXED
                                                            )
                                                            .description("description")
                                                            .addEmployeeDeduction(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .EmployeeDeduction
                                                                    .FIXED
                                                            )
                                                            .addFrequency(BenefitFrequency.ONE_TIME)
                                                            .addHsaContributionLimit(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .HsaContributionLimit
                                                                    .INDIVIDUAL
                                                            )
                                                            .build()
                                                    )
                                                    .supportedOperations(
                                                        SupportPerBenefitType.builder()
                                                            .companyBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .individualBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .build()
                                                    )
                                                    .build()
                                            )
                                            .s125Dental(
                                                BenefitFeaturesAndOperations.builder()
                                                    .supportedFeatures(
                                                        BenefitFeaturesAndOperations.BenefitFeature
                                                            .builder()
                                                            .annualMaximum(true)
                                                            .catchUp(true)
                                                            .addCompanyContribution(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .CompanyContribution
                                                                    .FIXED
                                                            )
                                                            .description("description")
                                                            .addEmployeeDeduction(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .EmployeeDeduction
                                                                    .FIXED
                                                            )
                                                            .addFrequency(BenefitFrequency.ONE_TIME)
                                                            .addHsaContributionLimit(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .HsaContributionLimit
                                                                    .INDIVIDUAL
                                                            )
                                                            .build()
                                                    )
                                                    .supportedOperations(
                                                        SupportPerBenefitType.builder()
                                                            .companyBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .individualBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .build()
                                                    )
                                                    .build()
                                            )
                                            .s125Medical(
                                                BenefitFeaturesAndOperations.builder()
                                                    .supportedFeatures(
                                                        BenefitFeaturesAndOperations.BenefitFeature
                                                            .builder()
                                                            .annualMaximum(true)
                                                            .catchUp(true)
                                                            .addCompanyContribution(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .CompanyContribution
                                                                    .FIXED
                                                            )
                                                            .description("description")
                                                            .addEmployeeDeduction(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .EmployeeDeduction
                                                                    .FIXED
                                                            )
                                                            .addFrequency(BenefitFrequency.ONE_TIME)
                                                            .addHsaContributionLimit(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .HsaContributionLimit
                                                                    .INDIVIDUAL
                                                            )
                                                            .build()
                                                    )
                                                    .supportedOperations(
                                                        SupportPerBenefitType.builder()
                                                            .companyBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .individualBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .build()
                                                    )
                                                    .build()
                                            )
                                            .s125Vision(
                                                BenefitFeaturesAndOperations.builder()
                                                    .supportedFeatures(
                                                        BenefitFeaturesAndOperations.BenefitFeature
                                                            .builder()
                                                            .annualMaximum(true)
                                                            .catchUp(true)
                                                            .addCompanyContribution(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .CompanyContribution
                                                                    .FIXED
                                                            )
                                                            .description("description")
                                                            .addEmployeeDeduction(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .EmployeeDeduction
                                                                    .FIXED
                                                            )
                                                            .addFrequency(BenefitFrequency.ONE_TIME)
                                                            .addHsaContributionLimit(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .HsaContributionLimit
                                                                    .INDIVIDUAL
                                                            )
                                                            .build()
                                                    )
                                                    .supportedOperations(
                                                        SupportPerBenefitType.builder()
                                                            .companyBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .individualBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .build()
                                                    )
                                                    .build()
                                            )
                                            .simple(
                                                BenefitFeaturesAndOperations.builder()
                                                    .supportedFeatures(
                                                        BenefitFeaturesAndOperations.BenefitFeature
                                                            .builder()
                                                            .annualMaximum(true)
                                                            .catchUp(true)
                                                            .addCompanyContribution(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .CompanyContribution
                                                                    .FIXED
                                                            )
                                                            .description("description")
                                                            .addEmployeeDeduction(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .EmployeeDeduction
                                                                    .FIXED
                                                            )
                                                            .addFrequency(BenefitFrequency.ONE_TIME)
                                                            .addHsaContributionLimit(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .HsaContributionLimit
                                                                    .INDIVIDUAL
                                                            )
                                                            .build()
                                                    )
                                                    .supportedOperations(
                                                        SupportPerBenefitType.builder()
                                                            .companyBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .individualBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .build()
                                                    )
                                                    .build()
                                            )
                                            .simpleIra(
                                                BenefitFeaturesAndOperations.builder()
                                                    .supportedFeatures(
                                                        BenefitFeaturesAndOperations.BenefitFeature
                                                            .builder()
                                                            .annualMaximum(true)
                                                            .catchUp(true)
                                                            .addCompanyContribution(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .CompanyContribution
                                                                    .FIXED
                                                            )
                                                            .description("description")
                                                            .addEmployeeDeduction(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .EmployeeDeduction
                                                                    .FIXED
                                                            )
                                                            .addFrequency(BenefitFrequency.ONE_TIME)
                                                            .addHsaContributionLimit(
                                                                BenefitFeaturesAndOperations
                                                                    .BenefitFeature
                                                                    .HsaContributionLimit
                                                                    .INDIVIDUAL
                                                            )
                                                            .build()
                                                    )
                                                    .supportedOperations(
                                                        SupportPerBenefitType.builder()
                                                            .companyBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .individualBenefits(
                                                                OperationSupportMatrix.builder()
                                                                    .create(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .delete(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .read(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .update(
                                                                        OperationSupport.SUPPORTED
                                                                    )
                                                                    .build()
                                                            )
                                                            .build()
                                                    )
                                                    .build()
                                            )
                                            .build()
                                    )
                                    .supportedFields(
                                        AccountUpdateEvent.Data.AuthenticationMethod.SupportedFields
                                            .builder()
                                            .company(
                                                AccountUpdateEvent.Data.AuthenticationMethod
                                                    .SupportedFields
                                                    .SupportedCompanyFields
                                                    .builder()
                                                    .id(true)
                                                    .accounts(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedCompanyFields
                                                            .Accounts
                                                            .builder()
                                                            .accountName(true)
                                                            .accountNumber(true)
                                                            .accountType(true)
                                                            .institutionName(true)
                                                            .routingNumber(true)
                                                            .build()
                                                    )
                                                    .departments(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedCompanyFields
                                                            .Departments
                                                            .builder()
                                                            .name(true)
                                                            .parent(
                                                                AccountUpdateEvent.Data
                                                                    .AuthenticationMethod
                                                                    .SupportedFields
                                                                    .SupportedCompanyFields
                                                                    .Departments
                                                                    .Parent
                                                                    .builder()
                                                                    .name(true)
                                                                    .build()
                                                            )
                                                            .build()
                                                    )
                                                    .ein(true)
                                                    .entity(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedCompanyFields
                                                            .Entity
                                                            .builder()
                                                            .subtype(true)
                                                            .type(true)
                                                            .build()
                                                    )
                                                    .legalName(true)
                                                    .locations(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedCompanyFields
                                                            .Locations
                                                            .builder()
                                                            .city(true)
                                                            .country(true)
                                                            .line1(true)
                                                            .line2(true)
                                                            .postalCode(true)
                                                            .state(true)
                                                            .build()
                                                    )
                                                    .primaryEmail(true)
                                                    .primaryPhoneNumber(true)
                                                    .build()
                                            )
                                            .directory(
                                                AccountUpdateEvent.Data.AuthenticationMethod
                                                    .SupportedFields
                                                    .SupportedDirectoryFields
                                                    .builder()
                                                    .individuals(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedDirectoryFields
                                                            .Individuals
                                                            .builder()
                                                            .id(true)
                                                            .department(true)
                                                            .firstName(true)
                                                            .isActive(true)
                                                            .lastName(true)
                                                            .manager(
                                                                AccountUpdateEvent.Data
                                                                    .AuthenticationMethod
                                                                    .SupportedFields
                                                                    .SupportedDirectoryFields
                                                                    .Individuals
                                                                    .Manager
                                                                    .builder()
                                                                    .id(true)
                                                                    .build()
                                                            )
                                                            .middleName(true)
                                                            .build()
                                                    )
                                                    .paging(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedDirectoryFields
                                                            .Paging
                                                            .builder()
                                                            .count(true)
                                                            .offset(true)
                                                            .build()
                                                    )
                                                    .build()
                                            )
                                            .employment(
                                                AccountUpdateEvent.Data.AuthenticationMethod
                                                    .SupportedFields
                                                    .SupportedEmploymentFields
                                                    .builder()
                                                    .id(true)
                                                    .classCode(true)
                                                    .customFields(true)
                                                    .department(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedEmploymentFields
                                                            .Department
                                                            .builder()
                                                            .name(true)
                                                            .build()
                                                    )
                                                    .employment(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedEmploymentFields
                                                            .Employment
                                                            .builder()
                                                            .subtype(true)
                                                            .type(true)
                                                            .build()
                                                    )
                                                    .employmentStatus(true)
                                                    .endDate(true)
                                                    .firstName(true)
                                                    .income(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedEmploymentFields
                                                            .Income
                                                            .builder()
                                                            .amount(true)
                                                            .currency(true)
                                                            .unit(true)
                                                            .build()
                                                    )
                                                    .incomeHistory(true)
                                                    .isActive(true)
                                                    .lastName(true)
                                                    .location(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedEmploymentFields
                                                            .Location
                                                            .builder()
                                                            .city(true)
                                                            .country(true)
                                                            .line1(true)
                                                            .line2(true)
                                                            .postalCode(true)
                                                            .state(true)
                                                            .build()
                                                    )
                                                    .manager(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedEmploymentFields
                                                            .Manager
                                                            .builder()
                                                            .id(true)
                                                            .build()
                                                    )
                                                    .middleName(true)
                                                    .startDate(true)
                                                    .title(true)
                                                    .build()
                                            )
                                            .individual(
                                                AccountUpdateEvent.Data.AuthenticationMethod
                                                    .SupportedFields
                                                    .SupportedIndividualFields
                                                    .builder()
                                                    .id(true)
                                                    .dob(true)
                                                    .emails(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedIndividualFields
                                                            .Emails
                                                            .builder()
                                                            .data(true)
                                                            .type(true)
                                                            .build()
                                                    )
                                                    .encryptedSsn(true)
                                                    .ethnicity(true)
                                                    .firstName(true)
                                                    .gender(true)
                                                    .lastName(true)
                                                    .middleName(true)
                                                    .phoneNumbers(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedIndividualFields
                                                            .PhoneNumbers
                                                            .builder()
                                                            .data(true)
                                                            .type(true)
                                                            .build()
                                                    )
                                                    .preferredName(true)
                                                    .residence(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedIndividualFields
                                                            .Residence
                                                            .builder()
                                                            .city(true)
                                                            .country(true)
                                                            .line1(true)
                                                            .line2(true)
                                                            .postalCode(true)
                                                            .state(true)
                                                            .build()
                                                    )
                                                    .ssn(true)
                                                    .build()
                                            )
                                            .payGroup(
                                                AccountUpdateEvent.Data.AuthenticationMethod
                                                    .SupportedFields
                                                    .SupportedPayGroupFields
                                                    .builder()
                                                    .id(true)
                                                    .individualIds(true)
                                                    .name(true)
                                                    .payFrequencies(true)
                                                    .build()
                                            )
                                            .payStatement(
                                                AccountUpdateEvent.Data.AuthenticationMethod
                                                    .SupportedFields
                                                    .SupportedPayStatementFields
                                                    .builder()
                                                    .paging(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedPayStatementFields
                                                            .Paging
                                                            .builder()
                                                            .count(true)
                                                            .offset(true)
                                                            .build()
                                                    )
                                                    .payStatements(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedPayStatementFields
                                                            .PayStatements
                                                            .builder()
                                                            .earnings(
                                                                AccountUpdateEvent.Data
                                                                    .AuthenticationMethod
                                                                    .SupportedFields
                                                                    .SupportedPayStatementFields
                                                                    .PayStatements
                                                                    .Earnings
                                                                    .builder()
                                                                    .amount(true)
                                                                    .currency(true)
                                                                    .name(true)
                                                                    .type(true)
                                                                    .build()
                                                            )
                                                            .employeeDeductions(
                                                                AccountUpdateEvent.Data
                                                                    .AuthenticationMethod
                                                                    .SupportedFields
                                                                    .SupportedPayStatementFields
                                                                    .PayStatements
                                                                    .EmployeeDeductions
                                                                    .builder()
                                                                    .amount(true)
                                                                    .currency(true)
                                                                    .name(true)
                                                                    .preTax(true)
                                                                    .type(true)
                                                                    .build()
                                                            )
                                                            .employerContributions(
                                                                AccountUpdateEvent.Data
                                                                    .AuthenticationMethod
                                                                    .SupportedFields
                                                                    .SupportedPayStatementFields
                                                                    .PayStatements
                                                                    .EmployerContributions
                                                                    .builder()
                                                                    .amount(true)
                                                                    .currency(true)
                                                                    .name(true)
                                                                    .build()
                                                            )
                                                            .grossPay(true)
                                                            .individualId(true)
                                                            .netPay(true)
                                                            .paymentMethod(true)
                                                            .taxes(
                                                                AccountUpdateEvent.Data
                                                                    .AuthenticationMethod
                                                                    .SupportedFields
                                                                    .SupportedPayStatementFields
                                                                    .PayStatements
                                                                    .Taxes
                                                                    .builder()
                                                                    .amount(true)
                                                                    .currency(true)
                                                                    .employer(true)
                                                                    .name(true)
                                                                    .type(true)
                                                                    .build()
                                                            )
                                                            .totalHours(true)
                                                            .type(true)
                                                            .build()
                                                    )
                                                    .build()
                                            )
                                            .payment(
                                                AccountUpdateEvent.Data.AuthenticationMethod
                                                    .SupportedFields
                                                    .SupportedPaymentFields
                                                    .builder()
                                                    .id(true)
                                                    .companyDebit(true)
                                                    .debitDate(true)
                                                    .employeeTaxes(true)
                                                    .employerTaxes(true)
                                                    .grossPay(true)
                                                    .individualIds(true)
                                                    .netPay(true)
                                                    .payDate(true)
                                                    .payFrequencies(true)
                                                    .payGroupIds(true)
                                                    .payPeriod(
                                                        AccountUpdateEvent.Data.AuthenticationMethod
                                                            .SupportedFields
                                                            .SupportedPaymentFields
                                                            .PayPeriod
                                                            .builder()
                                                            .endDate(true)
                                                            .startDate(true)
                                                            .build()
                                                    )
                                                    .build()
                                            )
                                            .build()
                                    )
                                    .type(
                                        AccountUpdateEvent.Data.AuthenticationMethod.Type.ASSISTED
                                    )
                                    .build()
                            )
                            .status(ConnectionStatusType.PENDING)
                            .build()
                    )
                    .eventType(AccountUpdateEvent.EventType.ACCOUNT_UPDATED)
                    .build()
            )

        val roundtrippedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(webhookEvent),
                jacksonTypeRef<WebhookEvent>(),
            )

        assertThat(roundtrippedWebhookEvent).isEqualTo(webhookEvent)
    }

    @Test
    fun ofJobCompletion() {
        val jobCompletion =
            JobCompletionEvent.builder()
                .accountId("account_id")
                .companyId("company_id")
                .connectionId("connection_id")
                .data(JobCompletionEvent.Data.builder().jobId("job_id").jobUrl("job_url").build())
                .eventType(JobCompletionEvent.EventType.JOB_BENEFIT_CREATE_COMPLETED)
                .build()

        val webhookEvent = WebhookEvent.ofJobCompletion(jobCompletion)

        assertThat(webhookEvent.accountUpdated()).isEmpty
        assertThat(webhookEvent.jobCompletion()).contains(jobCompletion)
        assertThat(webhookEvent.companyUpdated()).isEmpty
        assertThat(webhookEvent.directory()).isEmpty
        assertThat(webhookEvent.employment()).isEmpty
        assertThat(webhookEvent.individual()).isEmpty
        assertThat(webhookEvent.payment()).isEmpty
        assertThat(webhookEvent.payStatement()).isEmpty
    }

    @Test
    fun ofJobCompletionRoundtrip() {
        val jsonMapper = jsonMapper()
        val webhookEvent =
            WebhookEvent.ofJobCompletion(
                JobCompletionEvent.builder()
                    .accountId("account_id")
                    .companyId("company_id")
                    .connectionId("connection_id")
                    .data(
                        JobCompletionEvent.Data.builder().jobId("job_id").jobUrl("job_url").build()
                    )
                    .eventType(JobCompletionEvent.EventType.JOB_BENEFIT_CREATE_COMPLETED)
                    .build()
            )

        val roundtrippedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(webhookEvent),
                jacksonTypeRef<WebhookEvent>(),
            )

        assertThat(roundtrippedWebhookEvent).isEqualTo(webhookEvent)
    }

    @Test
    fun ofCompanyUpdated() {
        val companyUpdated =
            CompanyEvent.builder()
                .accountId("account_id")
                .companyId("company_id")
                .connectionId("connection_id")
                .data(
                    CompanyEvent.Data.builder()
                        .putAdditionalProperty("foo", JsonValue.from("bar"))
                        .build()
                )
                .eventType(CompanyEvent.EventType.COMPANY_UPDATED)
                .build()

        val webhookEvent = WebhookEvent.ofCompanyUpdated(companyUpdated)

        assertThat(webhookEvent.accountUpdated()).isEmpty
        assertThat(webhookEvent.jobCompletion()).isEmpty
        assertThat(webhookEvent.companyUpdated()).contains(companyUpdated)
        assertThat(webhookEvent.directory()).isEmpty
        assertThat(webhookEvent.employment()).isEmpty
        assertThat(webhookEvent.individual()).isEmpty
        assertThat(webhookEvent.payment()).isEmpty
        assertThat(webhookEvent.payStatement()).isEmpty
    }

    @Test
    fun ofCompanyUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val webhookEvent =
            WebhookEvent.ofCompanyUpdated(
                CompanyEvent.builder()
                    .accountId("account_id")
                    .companyId("company_id")
                    .connectionId("connection_id")
                    .data(
                        CompanyEvent.Data.builder()
                            .putAdditionalProperty("foo", JsonValue.from("bar"))
                            .build()
                    )
                    .eventType(CompanyEvent.EventType.COMPANY_UPDATED)
                    .build()
            )

        val roundtrippedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(webhookEvent),
                jacksonTypeRef<WebhookEvent>(),
            )

        assertThat(roundtrippedWebhookEvent).isEqualTo(webhookEvent)
    }

    @Test
    fun ofDirectory() {
        val directory =
            DirectoryEvent.builder()
                .accountId("account_id")
                .companyId("company_id")
                .connectionId("connection_id")
                .data(DirectoryEvent.Data.builder().individualId("individual_id").build())
                .eventType(DirectoryEvent.EventType.DIRECTORY_CREATED)
                .build()

        val webhookEvent = WebhookEvent.ofDirectory(directory)

        assertThat(webhookEvent.accountUpdated()).isEmpty
        assertThat(webhookEvent.jobCompletion()).isEmpty
        assertThat(webhookEvent.companyUpdated()).isEmpty
        assertThat(webhookEvent.directory()).contains(directory)
        assertThat(webhookEvent.employment()).isEmpty
        assertThat(webhookEvent.individual()).isEmpty
        assertThat(webhookEvent.payment()).isEmpty
        assertThat(webhookEvent.payStatement()).isEmpty
    }

    @Test
    fun ofDirectoryRoundtrip() {
        val jsonMapper = jsonMapper()
        val webhookEvent =
            WebhookEvent.ofDirectory(
                DirectoryEvent.builder()
                    .accountId("account_id")
                    .companyId("company_id")
                    .connectionId("connection_id")
                    .data(DirectoryEvent.Data.builder().individualId("individual_id").build())
                    .eventType(DirectoryEvent.EventType.DIRECTORY_CREATED)
                    .build()
            )

        val roundtrippedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(webhookEvent),
                jacksonTypeRef<WebhookEvent>(),
            )

        assertThat(roundtrippedWebhookEvent).isEqualTo(webhookEvent)
    }

    @Test
    fun ofEmployment() {
        val employment =
            EmploymentEvent.builder()
                .accountId("account_id")
                .companyId("company_id")
                .connectionId("connection_id")
                .data(EmploymentEvent.Data.builder().individualId("individual_id").build())
                .eventType(EmploymentEvent.EventType.EMPLOYMENT_CREATED)
                .build()

        val webhookEvent = WebhookEvent.ofEmployment(employment)

        assertThat(webhookEvent.accountUpdated()).isEmpty
        assertThat(webhookEvent.jobCompletion()).isEmpty
        assertThat(webhookEvent.companyUpdated()).isEmpty
        assertThat(webhookEvent.directory()).isEmpty
        assertThat(webhookEvent.employment()).contains(employment)
        assertThat(webhookEvent.individual()).isEmpty
        assertThat(webhookEvent.payment()).isEmpty
        assertThat(webhookEvent.payStatement()).isEmpty
    }

    @Test
    fun ofEmploymentRoundtrip() {
        val jsonMapper = jsonMapper()
        val webhookEvent =
            WebhookEvent.ofEmployment(
                EmploymentEvent.builder()
                    .accountId("account_id")
                    .companyId("company_id")
                    .connectionId("connection_id")
                    .data(EmploymentEvent.Data.builder().individualId("individual_id").build())
                    .eventType(EmploymentEvent.EventType.EMPLOYMENT_CREATED)
                    .build()
            )

        val roundtrippedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(webhookEvent),
                jacksonTypeRef<WebhookEvent>(),
            )

        assertThat(roundtrippedWebhookEvent).isEqualTo(webhookEvent)
    }

    @Test
    fun ofIndividual() {
        val individual =
            IndividualEvent.builder()
                .accountId("account_id")
                .companyId("company_id")
                .connectionId("connection_id")
                .data(IndividualEvent.Data.builder().individualId("individual_id").build())
                .eventType(IndividualEvent.EventType.INDIVIDUAL_CREATED)
                .build()

        val webhookEvent = WebhookEvent.ofIndividual(individual)

        assertThat(webhookEvent.accountUpdated()).isEmpty
        assertThat(webhookEvent.jobCompletion()).isEmpty
        assertThat(webhookEvent.companyUpdated()).isEmpty
        assertThat(webhookEvent.directory()).isEmpty
        assertThat(webhookEvent.employment()).isEmpty
        assertThat(webhookEvent.individual()).contains(individual)
        assertThat(webhookEvent.payment()).isEmpty
        assertThat(webhookEvent.payStatement()).isEmpty
    }

    @Test
    fun ofIndividualRoundtrip() {
        val jsonMapper = jsonMapper()
        val webhookEvent =
            WebhookEvent.ofIndividual(
                IndividualEvent.builder()
                    .accountId("account_id")
                    .companyId("company_id")
                    .connectionId("connection_id")
                    .data(IndividualEvent.Data.builder().individualId("individual_id").build())
                    .eventType(IndividualEvent.EventType.INDIVIDUAL_CREATED)
                    .build()
            )

        val roundtrippedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(webhookEvent),
                jacksonTypeRef<WebhookEvent>(),
            )

        assertThat(roundtrippedWebhookEvent).isEqualTo(webhookEvent)
    }

    @Test
    fun ofPayment() {
        val payment =
            PaymentEvent.builder()
                .accountId("account_id")
                .companyId("company_id")
                .connectionId("connection_id")
                .data(
                    PaymentEvent.PaymentIdentifiers.builder()
                        .payDate("pay_date")
                        .paymentId("payment_id")
                        .build()
                )
                .eventType(PaymentEvent.EventType.PAYMENT_CREATED)
                .build()

        val webhookEvent = WebhookEvent.ofPayment(payment)

        assertThat(webhookEvent.accountUpdated()).isEmpty
        assertThat(webhookEvent.jobCompletion()).isEmpty
        assertThat(webhookEvent.companyUpdated()).isEmpty
        assertThat(webhookEvent.directory()).isEmpty
        assertThat(webhookEvent.employment()).isEmpty
        assertThat(webhookEvent.individual()).isEmpty
        assertThat(webhookEvent.payment()).contains(payment)
        assertThat(webhookEvent.payStatement()).isEmpty
    }

    @Test
    fun ofPaymentRoundtrip() {
        val jsonMapper = jsonMapper()
        val webhookEvent =
            WebhookEvent.ofPayment(
                PaymentEvent.builder()
                    .accountId("account_id")
                    .companyId("company_id")
                    .connectionId("connection_id")
                    .data(
                        PaymentEvent.PaymentIdentifiers.builder()
                            .payDate("pay_date")
                            .paymentId("payment_id")
                            .build()
                    )
                    .eventType(PaymentEvent.EventType.PAYMENT_CREATED)
                    .build()
            )

        val roundtrippedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(webhookEvent),
                jacksonTypeRef<WebhookEvent>(),
            )

        assertThat(roundtrippedWebhookEvent).isEqualTo(webhookEvent)
    }

    @Test
    fun ofPayStatement() {
        val payStatement =
            PayStatementEvent.builder()
                .accountId("account_id")
                .companyId("company_id")
                .connectionId("connection_id")
                .data(
                    PayStatementEvent.Data.builder()
                        .individualId("individual_id")
                        .paymentId("payment_id")
                        .build()
                )
                .eventType(PayStatementEvent.EventType.PAY_STATEMENT_CREATED)
                .build()

        val webhookEvent = WebhookEvent.ofPayStatement(payStatement)

        assertThat(webhookEvent.accountUpdated()).isEmpty
        assertThat(webhookEvent.jobCompletion()).isEmpty
        assertThat(webhookEvent.companyUpdated()).isEmpty
        assertThat(webhookEvent.directory()).isEmpty
        assertThat(webhookEvent.employment()).isEmpty
        assertThat(webhookEvent.individual()).isEmpty
        assertThat(webhookEvent.payment()).isEmpty
        assertThat(webhookEvent.payStatement()).contains(payStatement)
    }

    @Test
    fun ofPayStatementRoundtrip() {
        val jsonMapper = jsonMapper()
        val webhookEvent =
            WebhookEvent.ofPayStatement(
                PayStatementEvent.builder()
                    .accountId("account_id")
                    .companyId("company_id")
                    .connectionId("connection_id")
                    .data(
                        PayStatementEvent.Data.builder()
                            .individualId("individual_id")
                            .paymentId("payment_id")
                            .build()
                    )
                    .eventType(PayStatementEvent.EventType.PAY_STATEMENT_CREATED)
                    .build()
            )

        val roundtrippedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(webhookEvent),
                jacksonTypeRef<WebhookEvent>(),
            )

        assertThat(roundtrippedWebhookEvent).isEqualTo(webhookEvent)
    }

    enum class IncompatibleJsonShapeTestCase(val value: JsonValue) {
        BOOLEAN(JsonValue.from(false)),
        STRING(JsonValue.from("invalid")),
        INTEGER(JsonValue.from(-1)),
        FLOAT(JsonValue.from(3.14)),
        ARRAY(JsonValue.from(listOf("invalid", "array"))),
    }

    @ParameterizedTest
    @EnumSource
    fun incompatibleJsonShapeDeserializesToUnknown(testCase: IncompatibleJsonShapeTestCase) {
        val webhookEvent = jsonMapper().convertValue(testCase.value, jacksonTypeRef<WebhookEvent>())

        val e = assertThrows<FinchInvalidDataException> { webhookEvent.validate() }
        assertThat(e).hasMessageStartingWith("Unknown ")
    }
}
